<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/YAME/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/YAME/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li:not(:nth-child(5)) > a, .site-nav > ul.nav-list:first-child > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(5) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(5) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(5) > ul.nav-list { display: block; } </style> <script src="/YAME/assets/js/vendor/lunr.min.js"></script> <script src="/YAME/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Methylation Data Enrichment | YAME</title> <meta name="generator" content="Jekyll v4.3.4" /> <meta property="og:title" content="Methylation Data Enrichment" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/YAME/docs/enrichment.html" /> <meta property="og:url" content="http://localhost:4000/YAME/docs/enrichment.html" /> <meta property="og:site_name" content="YAME" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Methylation Data Enrichment" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","headline":"Methylation Data Enrichment","url":"http://localhost:4000/YAME/docs/enrichment.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/YAME/" class="site-title lh-tight"> YAME </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/YAME/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/YAME/docs/pack_unpack.html" class="nav-list-link">Methylation Data Storage</a></li><li class="nav-list-item"><a href="/YAME/docs/subset.html" class="nav-list-link">Methylation Data Subset</a></li><li class="nav-list-item"><a href="/YAME/docs/summarize.html" class="nav-list-link">Methylation Data Summarization</a></li><li class="nav-list-item"><a href="/YAME/docs/enrichment.html" class="nav-list-link">Methylation Data Enrichment</a></li><li class="nav-list-item"><a href="/YAME/docs/rowop.html" class="nav-list-link">Methylation Data Row Operations</a></li><li class="nav-list-item"><a href="/YAME/docs/sample.html" class="nav-list-link">Methylation Data Sample Operations</a></li><li class="nav-list-item"><a href="/YAME/docs/dsample.html" class="nav-list-link">Methylation Data Downsampling</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in YAME Subcommands category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/YAME/docs/subcommands" class="nav-list-link">YAME Subcommands</a><ul class="nav-list"><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_pack.html" class="nav-list-link">yame pack</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_unpack.html" class="nav-list-link">yame unpack</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_subset.html" class="nav-list-link">yame subset</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_rowsub.html" class="nav-list-link">yame rowsub</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_info.html" class="nav-list-link">yame info</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_summary.html" class="nav-list-link">yame summary</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_index.html" class="nav-list-link">yame index</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_split.html" class="nav-list-link">yame split</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_chunk.html" class="nav-list-link">yame chunk</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_chunkchar.html" class="nav-list-link">yame chunkchar</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_rowop.html" class="nav-list-link">yame rowop</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_mask.html" class="nav-list-link">yame mask</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_dsample.html" class="nav-list-link">yame dsample</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search YAME" aria-label="Search YAME" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/Hongxiang2023/YAME" class="site-button" > YAME on GitHub </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <div id="main-content" class="main-content"> <main> <h1 id="tutorial-enrichment-testing-with-yame"> <a href="#tutorial-enrichment-testing-with-yame" class="anchor-heading" aria-labelledby="tutorial-enrichment-testing-with-yame"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tutorial: Enrichment Testing with YAME </h1> <h2 id="prerequisites"> <a href="#prerequisites" class="anchor-heading" aria-labelledby="prerequisites"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Prerequisites </h2> <ol> <li>A bed file containing the output significant coordinates from differential analysis</li> <li>Installed <a href="https://bedtools.readthedocs.io/en/latest/content/installation.html">bedtools</a> on your system</li> <li>A reference coordinate bed file (We have provided hg38 and mm10 CpG reference coordinate annotations .cr on KYCG github) <a href="https://github.com/zhou-lab/KYCGKB_mm10">mm10</a>/<a href="https://github.com/zhou-lab/KYCGKB_hg38">hg38</a>.</li> </ol> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yame unpack cpg_nocontig.cr | <span class="nb">gzip</span> <span class="o">&gt;</span> cpg_nocontig.bed.gz
</code></pre></div></div> <h2 id="file-preparation"> <a href="#file-preparation" class="anchor-heading" aria-labelledby="file-preparation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> File preparation </h2> <p>First, we will pack the bedfile into a .cx format. If the input bedfile is already sorted, you can start with the intersect step. Check out the <a href="https://bedtools.readthedocs.io/en/latest/content/tools/intersect.html">bedtools instersect help page</a> if you encounter any problems at this step.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bedtools <span class="nb">sort</span> <span class="nt">-i</span> yourfile.bed | bedtools intersect <span class="nt">-a</span> cpg_nocontig.bed.gz <span class="nt">-b</span> - <span class="nt">-sorted</span> <span class="nt">-c</span> | <span class="nb">cut</span> <span class="nt">-f4</span> | yame pack <span class="nt">-fb</span> - <span class="o">&gt;</span> yourfile.cg   
</code></pre></div></div> <h2 id="enrichment-testing"> <a href="#enrichment-testing" class="anchor-heading" aria-labelledby="enrichment-testing"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enrichment testing </h2> <p>Then we simply run <a href="/YAME/docs/summarize.html"><code class="language-plaintext highlighter-rouge">yame summary</code></a> with <code class="language-plaintext highlighter-rouge">-m</code> feature file for enrichment testing. We have provided comprehensive enrichment feature files, and you can download them from th KYCG github page <a href="https://github.com/zhou-lab/KYCGKB_mm10">mm10</a>/<a href="https://github.com/zhou-lab/KYCGKB_hg38">hg38</a>. You can also create your own feature file with <a href="/YAME/docs/pack_unpack.html"><code class="language-plaintext highlighter-rouge">yame pack</code></a>.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yame summary <span class="nt">-m</span> feature.cm yourfile.cg <span class="o">&gt;</span> yourfile.txt
</code></pre></div></div> <h2 id="output-interpretations"> <a href="#output-interpretations" class="anchor-heading" aria-labelledby="output-interpretations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Output interpretations </h2> <p>Detailed information of the output columns can be found on the <a href="/YAME/docs/summarize.html"><code class="language-plaintext highlighter-rouge">yame summary</code></a> page. Basically, a higher log2oddsratio indicates a stronger association between the feature being tested and the query set. Generally, a large log2 odds ratio is typically considered to be around 2 or greater, with values between 1 and 2 often being viewed as potentially important and worthy of further investigation, while values around 0.5 might be considered a small effect size. For significance testing, <a href="https://www.bioconductor.org/packages/release/bioc/html/sesame.html">seasame</a> R package provided the testEnrichmentFisherN function, which is also provided in the yame github R page. The four input parameters correspond to the four columns from yame summary output.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ND = N_mask
NQ = N_query
NDQ = N_overlap
NU = N_universe
</code></pre></div></div> <h2 id="enrichment-testing-with-background"> <a href="#enrichment-testing-with-background" class="anchor-heading" aria-labelledby="enrichment-testing-with-background"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enrichment testing with background </h2> <p>Selecting the appropriate background for enrichment testing is crucial because it can significantly impact the interpretation of the results. Usually, we use the background set that is measured in the experiment under different conditions. To enable enrichment testing with background, we need to prepare the .cx file to include the two bed files (one is for the query set, one is for the background set).</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bedtools intersect <span class="nt">-a</span> cpg_nocontig.bed.gz <span class="nt">-b</span> query.bed <span class="nt">-sorted</span> <span class="nt">-c</span> | <span class="nb">cut</span> <span class="nt">-f4</span> <span class="o">&gt;</span> query_intersect.bed
bedtools intersect <span class="nt">-a</span> cpg_nocontig.bed.gz <span class="nt">-b</span> background.bed <span class="nt">-sorted</span> <span class="nt">-c</span> | <span class="nb">cut</span> <span class="nt">-f4</span> <span class="o">&gt;</span> background_intersect.bed
</code></pre></div></div> <p>And then we put them together where the first column is the query and the second column is the background set.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">paste </span>query_intersect.bed background_intersect.bed | yame pack <span class="nt">-f6</span> - <span class="o">&gt;</span> query_background.cg
</code></pre></div></div> <p>Conducting enrichment testing with background using <code class="language-plaintext highlighter-rouge">yame summary</code> is the same procedure as shown above.</p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
