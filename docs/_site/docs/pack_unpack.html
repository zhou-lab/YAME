<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/YAME/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/YAME/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li:not(:nth-child(5)) > a, .site-nav > ul.nav-list:first-child > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(5) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(5) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(5) > ul.nav-list { display: block; } </style> <script src="/YAME/assets/js/vendor/lunr.min.js"></script> <script src="/YAME/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Storage &amp; Format | YAME</title> <meta name="generator" content="Jekyll v4.3.4" /> <meta property="og:title" content="Storage &amp; Format" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/YAME/docs/pack_unpack.html" /> <meta property="og:url" content="http://localhost:4000/YAME/docs/pack_unpack.html" /> <meta property="og:site_name" content="YAME" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Storage &amp; Format" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","headline":"Storage &amp; Format","url":"http://localhost:4000/YAME/docs/pack_unpack.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/YAME/" class="site-title lh-tight"> YAME </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/YAME/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/YAME/docs/summarize.html" class="nav-list-link">Summary and Encoding</a></li><li class="nav-list-item"><a href="/YAME/docs/storage.html" class="nav-list-link">Storage & Format</a></li><li class="nav-list-item"><a href="/YAME/docs/enrichment.html" class="nav-list-link">Enrichment Testing</a></li><li class="nav-list-item"><a href="/YAME/docs/pack_unpack.html" class="nav-list-link">Storage & Format</a></li><li class="nav-list-item"><a href="/YAME/docs/subset.html" class="nav-list-link">Methylation Data Subset</a></li><li class="nav-list-item"><a href="/YAME/docs/rowop.html" class="nav-list-link">Row Subset/Operations</a></li><li class="nav-list-item"><a href="/YAME/docs/sample.html" class="nav-list-link">Sample Combination/Indexing</a></li><li class="nav-list-item"><a href="/YAME/docs/dsample.html" class="nav-list-link">Downsampling</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in YAME Subcommands category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/YAME/docs/subcommands" class="nav-list-link">YAME Subcommands</a><ul class="nav-list"><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_pack.html" class="nav-list-link">yame pack</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_unpack.html" class="nav-list-link">yame unpack</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_subset.html" class="nav-list-link">yame subset</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_rowsub.html" class="nav-list-link">yame rowsub</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_info.html" class="nav-list-link">yame info</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_summary.html" class="nav-list-link">yame summary</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_index.html" class="nav-list-link">yame index</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_split.html" class="nav-list-link">yame split</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_chunk.html" class="nav-list-link">yame chunk</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_chunkchar.html" class="nav-list-link">yame chunkchar</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_rowop.html" class="nav-list-link">yame rowop</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_mask.html" class="nav-list-link">yame mask</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_dsample.html" class="nav-list-link">yame dsample</a></li><li class="nav-list-item"><a href="/YAME/docs/subcommands/YAME_pairwise.html" class="nav-list-link">yame pairwise</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search YAME" aria-label="Search YAME" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/zhou-lab/YAME" class="site-button" > YAME on GitHub </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <div id="main-content" class="main-content"> <main> <h1 class="no_toc" id="methylation-data-packing-and-unpacking"> <a href="#methylation-data-packing-and-unpacking" class="anchor-heading" aria-labelledby="methylation-data-packing-and-unpacking"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Methylation Data Packing and Unpacking </h1> <p class="fs-6 fw-300">Convert between text and compressed CX binary formats for efficient storage and analysis.</p> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of Contents </h2> <ol id="markdown-toc"> <li><a href="#overview" id="markdown-toc-overview">Overview</a> <ol> <li><a href="#why-use-cx-formats" id="markdown-toc-why-use-cx-formats">Why Use CX Formats?</a></li> <li><a href="#key-concepts" id="markdown-toc-key-concepts">Key Concepts</a></li> </ol> </li> <li><a href="#understanding-cx-formats" id="markdown-toc-understanding-cx-formats">Understanding CX Formats</a> <ol> <li><a href="#the-cx-format-family" id="markdown-toc-the-cx-format-family">The CX Format Family</a></li> <li><a href="#choosing-the-right-format" id="markdown-toc-choosing-the-right-format">Choosing the Right Format</a></li> </ol> </li> <li><a href="#yame-pack" id="markdown-toc-yame-pack">yame pack</a> <ol> <li><a href="#basic-syntax" id="markdown-toc-basic-syntax">Basic Syntax</a></li> <li><a href="#essential-options" id="markdown-toc-essential-options">Essential Options</a></li> <li><a href="#critical-input-requirement" id="markdown-toc-critical-input-requirement">Critical Input Requirement</a></li> </ol> </li> <li><a href="#format-specific-packing-examples" id="markdown-toc-format-specific-packing-examples">Format-Specific Packing Examples</a> <ol> <li><a href="#format-0b---binary-data" id="markdown-toc-format-0b---binary-data">Format 0/b - Binary Data</a></li> <li><a href="#format-2s---chromatin-states" id="markdown-toc-format-2s---chromatin-states">Format 2/s - Chromatin States</a></li> <li><a href="#format-3---mu-sequencing-counts" id="markdown-toc-format-3---mu-sequencing-counts">Format 3 - M/U Sequencing Counts</a></li> <li><a href="#format-4---methylation-fractions" id="markdown-toc-format-4---methylation-fractions">Format 4 - Methylation Fractions</a></li> <li><a href="#format-5---differential-methylation" id="markdown-toc-format-5---differential-methylation">Format 5 - Differential Methylation</a></li> <li><a href="#format-6---set-and-universe" id="markdown-toc-format-6---set-and-universe">Format 6 - Set and Universe</a></li> <li><a href="#format-7---reference-coordinates" id="markdown-toc-format-7---reference-coordinates">Format 7 - Reference Coordinates</a></li> </ol> </li> <li><a href="#creating-feature-files---complete-guide" id="markdown-toc-creating-feature-files---complete-guide">Creating Feature Files - Complete Guide</a> <ol> <li><a href="#example-1-chromhmm-chromatin-states" id="markdown-toc-example-1-chromhmm-chromatin-states">Example 1: ChromHMM Chromatin States</a> <ol> <li><a href="#input-data-format" id="markdown-toc-input-data-format">Input Data Format</a></li> <li><a href="#step-by-step-workflow" id="markdown-toc-step-by-step-workflow">Step-by-Step Workflow</a></li> </ol> </li> <li><a href="#example-2-histone-modification-peaks" id="markdown-toc-example-2-histone-modification-peaks">Example 2: Histone Modification Peaks</a></li> <li><a href="#example-3-gene-annotations" id="markdown-toc-example-3-gene-annotations">Example 3: Gene Annotations</a></li> <li><a href="#example-4-genomic-binswindows" id="markdown-toc-example-4-genomic-binswindows">Example 4: Genomic Bins/Windows</a></li> <li><a href="#example-5-custom-region-sets" id="markdown-toc-example-5-custom-region-sets">Example 5: Custom Region Sets</a></li> </ol> </li> <li><a href="#yame-unpack" id="markdown-toc-yame-unpack">yame unpack</a> <ol> <li><a href="#basic-syntax-1" id="markdown-toc-basic-syntax-1">Basic Syntax</a></li> <li><a href="#common-options" id="markdown-toc-common-options">Common Options</a></li> </ol> </li> <li><a href="#unpacking-examples" id="markdown-toc-unpacking-examples">Unpacking Examples</a> <ol> <li><a href="#format-3---mu-count-data" id="markdown-toc-format-3---mu-count-data">Format 3 - M/U Count Data</a></li> <li><a href="#format-0b---binary-data-1" id="markdown-toc-format-0b---binary-data-1">Format 0/b - Binary Data</a></li> <li><a href="#format-2s---state-data" id="markdown-toc-format-2s---state-data">Format 2/s - State Data</a></li> <li><a href="#format-7---reference-coordinates-1" id="markdown-toc-format-7---reference-coordinates-1">Format 7 - Reference Coordinates</a></li> <li><a href="#unpacking-specific-samples" id="markdown-toc-unpacking-specific-samples">Unpacking Specific Samples</a></li> </ol> </li> <li><a href="#practical-workflows" id="markdown-toc-practical-workflows">Practical Workflows</a> <ol> <li><a href="#workflow-1-process-bisulfite-sequencing-data" id="markdown-toc-workflow-1-process-bisulfite-sequencing-data">Workflow 1: Process Bisulfite Sequencing Data</a></li> <li><a href="#workflow-2-create-multi-feature-database" id="markdown-toc-workflow-2-create-multi-feature-database">Workflow 2: Create Multi-Feature Database</a></li> <li><a href="#workflow-3-convert-array-data-to-cx-format" id="markdown-toc-workflow-3-convert-array-data-to-cx-format">Workflow 3: Convert Array Data to CX Format</a></li> <li><a href="#workflow-4-quality-control-pipeline" id="markdown-toc-workflow-4-quality-control-pipeline">Workflow 4: Quality Control Pipeline</a></li> </ol> </li> <li><a href="#best-practices" id="markdown-toc-best-practices">Best Practices</a> <ol> <li><a href="#for-packing" id="markdown-toc-for-packing">For Packing</a></li> <li><a href="#for-feature-files" id="markdown-toc-for-feature-files">For Feature Files</a></li> <li><a href="#for-unpacking" id="markdown-toc-for-unpacking">For Unpacking</a></li> </ol> </li> <li><a href="#format-selection-guide" id="markdown-toc-format-selection-guide">Format Selection Guide</a></li> <li><a href="#troubleshooting" id="markdown-toc-troubleshooting">Troubleshooting</a> <ol> <li><a href="#common-issues" id="markdown-toc-common-issues">Common Issues</a></li> </ol> </li> <li><a href="#performance-optimization" id="markdown-toc-performance-optimization">Performance Optimization</a> <ol> <li><a href="#speed-tips" id="markdown-toc-speed-tips">Speed Tips</a></li> <li><a href="#storage-tips" id="markdown-toc-storage-tips">Storage Tips</a></li> </ol> </li> <li><a href="#validation-and-testing" id="markdown-toc-validation-and-testing">Validation and Testing</a></li> </ol><hr /> <h2 id="overview"> <a href="#overview" class="anchor-heading" aria-labelledby="overview"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overview </h2> <p>YAME’s <code class="language-plaintext highlighter-rouge">pack</code> and <code class="language-plaintext highlighter-rouge">unpack</code> commands provide bidirectional conversion between human-readable text formats and the compressed CX binary format family. The CX formats dramatically reduce storage requirements (often 10-100x compression) while enabling rapid analysis operations.</p> <h3 id="why-use-cx-formats"> <a href="#why-use-cx-formats" class="anchor-heading" aria-labelledby="why-use-cx-formats"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Why Use CX Formats? </h3> <ul> <li><strong>Massive compression</strong> - Reduce storage from gigabytes to megabytes</li> <li><strong>Fast I/O</strong> - BGZF compression enables rapid reading/writing</li> <li><strong>Uniform structure</strong> - All formats share consistent internal architecture</li> <li><strong>Optimized for methylation</strong> - Each format designed for specific data types</li> <li><strong>Seamless integration</strong> - Works with all YAME commands and external tools</li> </ul> <h3 id="key-concepts"> <a href="#key-concepts" class="anchor-heading" aria-labelledby="key-concepts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Key Concepts </h3> <ul> <li><strong>Packing</strong> - Convert text data (BED, TSV, CSV) to compressed binary CX format</li> <li><strong>Unpacking</strong> - Convert CX format back to human-readable text</li> <li><strong>Format specification</strong> - Different CX formats optimized for different data types</li> <li><strong>Reference coordinates</strong> - All data must align with reference CpG coordinate order</li> <li><strong>BGZF compression</strong> - Block-compressed format allowing random access</li> </ul><hr /> <h2 id="understanding-cx-formats"> <a href="#understanding-cx-formats" class="anchor-heading" aria-labelledby="understanding-cx-formats"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Understanding CX Formats </h2> <h3 id="the-cx-format-family"> <a href="#the-cx-format-family" class="anchor-heading" aria-labelledby="the-cx-format-family"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The CX Format Family </h3> <p>YAME supports 8 different CX formats, each optimized for specific data types:</p> <div class="table-wrapper"><table> <thead> <tr> <th>Format</th> <th>Type Code</th> <th>File Ext</th> <th>Data Type</th> <th>Compression Method</th> <th>Best For</th> </tr> </thead> <tbody> <tr> <td><strong>Format 0</strong></td> <td><code class="language-plaintext highlighter-rouge">b</code> or <code class="language-plaintext highlighter-rouge">0</code></td> <td><code class="language-plaintext highlighter-rouge">.cg</code></td> <td>Binary</td> <td>1 byte per 8 CpGs</td> <td>Presence/absence, DMR calls</td> </tr> <tr> <td><strong>Format 1</strong></td> <td><code class="language-plaintext highlighter-rouge">1</code></td> <td><code class="language-plaintext highlighter-rouge">.cg</code></td> <td>Value + RLE</td> <td>Value (1B) + RLE (2B)</td> <td>Compressed integer counts</td> </tr> <tr> <td><strong>Format 2</strong></td> <td><code class="language-plaintext highlighter-rouge">s</code> or <code class="language-plaintext highlighter-rouge">2</code></td> <td><code class="language-plaintext highlighter-rouge">.cm</code></td> <td>State + RLE</td> <td>State labels + Index RLE</td> <td>Chromatin states, genomic features</td> </tr> <tr> <td><strong>Format 3</strong></td> <td><code class="language-plaintext highlighter-rouge">3</code></td> <td><code class="language-plaintext highlighter-rouge">.cg</code></td> <td>MU RLE</td> <td>M/U counts + Ladder byte</td> <td>Bisulfite sequencing (M,U)</td> </tr> <tr> <td><strong>Format 4</strong></td> <td><code class="language-plaintext highlighter-rouge">4</code></td> <td><code class="language-plaintext highlighter-rouge">.cg</code></td> <td>Fraction + NA-RLE</td> <td>Float fraction + NA encoding</td> <td>Methylation beta values</td> </tr> <tr> <td><strong>Format 5</strong></td> <td><code class="language-plaintext highlighter-rouge">5</code></td> <td><code class="language-plaintext highlighter-rouge">.cg</code></td> <td>2-bit + NA-RLE</td> <td>Ternary values {0,1,2}</td> <td>Differential calls (hypo/unchanged/hyper)</td> </tr> <tr> <td><strong>Format 6</strong></td> <td><code class="language-plaintext highlighter-rouge">6</code></td> <td><code class="language-plaintext highlighter-rouge">.cg</code></td> <td>2-bit boolean</td> <td>Set and universe flags</td> <td>Query + background for enrichment</td> </tr> <tr> <td><strong>Format 7</strong></td> <td><code class="language-plaintext highlighter-rouge">7</code></td> <td><code class="language-plaintext highlighter-rouge">.cr</code></td> <td>Compressed BED</td> <td>Delta-encoded coordinates</td> <td>CpG reference coordinates</td> </tr> </tbody> </table></div> <h3 id="choosing-the-right-format"> <a href="#choosing-the-right-format" class="anchor-heading" aria-labelledby="choosing-the-right-format"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Choosing the Right Format </h3> <p><strong>Quick Decision Tree:</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>What type of data do you have?

├─ Binary (yes/no, present/absent)
│  └─&gt; Format 0 (b)
│
├─ Chromatin states or categorical features
│  └─&gt; Format 2 (s)
│
├─ M and U count pairs from bisulfite sequencing
│  └─&gt; Format 3
│
├─ Beta values or methylation fractions (0.0-1.0)
│  └─&gt; Format 4
│
├─ Differential calls (hypomethylated/unchanged/hypermethylated)
│  └─&gt; Format 5
│
├─ Query + background for enrichment testing
│  └─&gt; Format 6
│
└─ Reference genomic coordinates
   └─&gt; Format 7
</code></pre></div></div><hr /> <h2 id="yame-pack"> <a href="#yame-pack" class="anchor-heading" aria-labelledby="yame-pack"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> yame pack </h2> <h3 id="basic-syntax"> <a href="#basic-syntax" class="anchor-heading" aria-labelledby="basic-syntax"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Basic Syntax </h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yame pack <span class="nt">-f</span>&lt;format&gt; <span class="o">[</span>options] &lt;input_file&gt; <span class="o">[</span>output_file]
</code></pre></div></div> <h3 id="essential-options"> <a href="#essential-options" class="anchor-heading" aria-labelledby="essential-options"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Essential Options </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Option</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">-f&lt;format&gt;</code></td> <td>Format specification (required)</td> <td><code class="language-plaintext highlighter-rouge">-fb</code>, <code class="language-plaintext highlighter-rouge">-f2</code>, <code class="language-plaintext highlighter-rouge">-f3</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">-</code></td> <td>Read from stdin</td> <td><code class="language-plaintext highlighter-rouge">cat data.txt \| yame pack -fb -</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">output.cg</code></td> <td>Output filename (optional)</td> <td><code class="language-plaintext highlighter-rouge">yame pack -fb input.txt output.cg</code></td> </tr> </tbody> </table></div> <h3 id="critical-input-requirement"> <a href="#critical-input-requirement" class="anchor-heading" aria-labelledby="critical-input-requirement"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Critical Input Requirement </h3> <p>⚠️ <strong>Your input MUST match reference CpG coordinates exactly:</strong></p> <ol> <li><strong>Same number of rows</strong> as reference CpGs</li> <li><strong>Same order</strong> as reference CpGs</li> <li><strong>One value per CpG</strong> in reference</li> </ol> <p><strong>How to ensure alignment:</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Step 1: Get reference coordinates</span>
yame unpack cpg_nocontig.cr | <span class="nb">gzip</span> <span class="o">&gt;</span> cpg_ref.bed.gz

<span class="c"># Step 2: Intersect your BED file with reference</span>
bedtools intersect <span class="nt">-a</span> cpg_ref.bed.gz <span class="nt">-b</span> your_data.bed <span class="nt">-sorted</span> <span class="nt">-c</span> | <span class="se">\</span>
  <span class="nb">cut</span> <span class="nt">-f4</span> | <span class="se">\</span>
  yame pack <span class="nt">-fb</span> - <span class="o">&gt;</span> aligned_output.cg
</code></pre></div></div><hr /> <h2 id="format-specific-packing-examples"> <a href="#format-specific-packing-examples" class="anchor-heading" aria-labelledby="format-specific-packing-examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Format-Specific Packing Examples </h2> <h3 id="format-0b---binary-data"> <a href="#format-0b---binary-data" class="anchor-heading" aria-labelledby="format-0b---binary-data"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Format 0/b - Binary Data </h3> <p><strong>Use case:</strong> Presence/absence, binary methylation calls, DMR indicators</p> <p><strong>Input:</strong> One line per CpG, values 0 or 1</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Example input (binary_data.txt):</span>
<span class="c"># 1</span>
<span class="c"># 0</span>
<span class="c"># 1</span>
<span class="c"># 1</span>
<span class="c"># 0</span>

<span class="c"># Pack from text file</span>
yame pack <span class="nt">-fb</span> binary_data.txt <span class="o">&gt;</span> binary_output.cg

<span class="c"># Pack from BED file via bedtools</span>
bedtools <span class="nb">sort</span> <span class="nt">-i</span> dmr_sites.bed | <span class="se">\</span>
  bedtools intersect <span class="nt">-a</span> cpg_ref.bed.gz <span class="nt">-b</span> - <span class="nt">-sorted</span> <span class="nt">-c</span> | <span class="se">\</span>
  <span class="nb">cut</span> <span class="nt">-f4</span> | <span class="se">\</span>
  yame pack <span class="nt">-fb</span> - <span class="o">&gt;</span> dmr_binary.cg
</code></pre></div></div> <p><strong>Compression:</strong> ~32x reduction (8 CpGs per byte)</p><hr /> <h3 id="format-2s---chromatin-states"> <a href="#format-2s---chromatin-states" class="anchor-heading" aria-labelledby="format-2s---chromatin-states"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Format 2/s - Chromatin States </h3> <p><strong>Use case:</strong> Categorical annotations, chromatin states, genomic features</p> <p><strong>Input:</strong> One line per CpG, containing state label (text string)</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Example input (states.txt):</span>
<span class="c"># TssA</span>
<span class="c"># TssFlnk</span>
<span class="c"># TxFlnk</span>
<span class="c"># Tx</span>
<span class="c"># Tx</span>
<span class="c"># EnhG</span>
<span class="c"># Enh</span>

<span class="c"># Pack state data</span>
yame pack <span class="nt">-f2</span> states.txt <span class="o">&gt;</span> chromatin_states.cm

<span class="c"># Or use 's' shorthand</span>
yame pack <span class="nt">-fs</span> states.txt <span class="o">&gt;</span> chromatin_states.cm
</code></pre></div></div> <p><strong>Special property:</strong> Excellent for feature files with many categories</p><hr /> <h3 id="format-3---mu-sequencing-counts"> <a href="#format-3---mu-sequencing-counts" class="anchor-heading" aria-labelledby="format-3---mu-sequencing-counts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Format 3 - M/U Sequencing Counts </h3> <p><strong>Use case:</strong> Bisulfite sequencing methylated (M) and unmethylated (U) read counts</p> <p><strong>Input:</strong> Two tab-separated columns per line (M count, U count)</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Example input (mu_counts.txt):</span>
<span class="c"># 12    3</span>
<span class="c"># 8     8</span>
<span class="c"># 0     15</span>
<span class="c"># 20    2</span>
<span class="c"># 0     0</span>
<span class="c"># 5     10</span>

<span class="c"># Pack M/U count data</span>
yame pack <span class="nt">-f3</span> mu_counts.txt <span class="o">&gt;</span> sequencing_data.cg
</code></pre></div></div> <p><strong>Compression:</strong> Highly efficient for typical sequencing coverage distributions</p> <p><strong>Note:</strong> M and U can be any non-negative integers</p><hr /> <h3 id="format-4---methylation-fractions"> <a href="#format-4---methylation-fractions" class="anchor-heading" aria-labelledby="format-4---methylation-fractions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Format 4 - Methylation Fractions </h3> <p><strong>Use case:</strong> Beta values, methylation fractions, continuous values 0.0-1.0</p> <p><strong>Input:</strong> One line per CpG, float values between 0 and 1 (or NA)</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Example input (beta_values.txt):</span>
<span class="c"># 0.75</span>
<span class="c"># 0.33</span>
<span class="c"># 0.88</span>
<span class="c"># NA</span>
<span class="c"># 0.50</span>
<span class="c"># 0.92</span>

<span class="c"># Pack fraction data</span>
yame pack <span class="nt">-f4</span> beta_values.txt <span class="o">&gt;</span> methylation_fractions.cg
</code></pre></div></div> <p><strong>Special handling:</strong></p> <ul> <li>NA values are properly encoded</li> <li>Preserves precision for methylation fractions</li> <li>Efficient for array data</li> </ul><hr /> <h3 id="format-5---differential-methylation"> <a href="#format-5---differential-methylation" class="anchor-heading" aria-labelledby="format-5---differential-methylation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Format 5 - Differential Methylation </h3> <p><strong>Use case:</strong> Three-state differential calls</p> <p><strong>Input:</strong> One line per CpG, values {0, 1, 2} only</p> <ul> <li><strong>0</strong> = Hypomethylated</li> <li><strong>1</strong> = Unchanged / Not significant</li> <li><strong>2</strong> = Hypermethylated</li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Example input (diff_calls.txt):</span>
<span class="c"># 0</span>
<span class="c"># 1</span>
<span class="c"># 2</span>
<span class="c"># 1</span>
<span class="c"># 0</span>
<span class="c"># 2</span>

<span class="c"># Pack differential calls</span>
yame pack <span class="nt">-f5</span> diff_calls.txt <span class="o">&gt;</span> differential.cg
</code></pre></div></div> <p><strong>Compression:</strong> 2 bits per CpG (4 CpGs per byte)</p><hr /> <h3 id="format-6---set-and-universe"> <a href="#format-6---set-and-universe" class="anchor-heading" aria-labelledby="format-6---set-and-universe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Format 6 - Set and Universe </h3> <p><strong>Use case:</strong> Enrichment testing with query set and background/universe</p> <p><strong>Input:</strong> Two tab-separated columns</p> <ul> <li>Column 1: Query set (0 or 1)</li> <li>Column 2: Universe/background (0 or 1)</li> </ul> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Example input (query_universe.txt):</span>
<span class="c"># 1    1   (in query, in universe)</span>
<span class="c"># 0    1   (not in query, in universe)</span>
<span class="c"># 1    1   (in query, in universe)</span>
<span class="c"># 0    0   (not in query, not in universe)</span>

<span class="c"># Pack query + universe</span>
yame pack <span class="nt">-f6</span> query_universe.txt <span class="o">&gt;</span> query_bg.cg
</code></pre></div></div> <p><strong>Use case:</strong> More precise enrichment testing (see <a href="/YAME/docs/enrichment.html">enrichment guide</a>)</p><hr /> <h3 id="format-7---reference-coordinates"> <a href="#format-7---reference-coordinates" class="anchor-heading" aria-labelledby="format-7---reference-coordinates"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Format 7 - Reference Coordinates </h3> <p><strong>Use case:</strong> CpG reference coordinate files</p> <p><strong>Input:</strong> BED format with CpG identifiers</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Example input (cpg_coords.bed):</span>
<span class="c"># chr1    10468   10469   chr1_10469</span>
<span class="c"># chr1    10470   10471   chr1_10471</span>
<span class="c"># chr1    10483   10484   chr1_10484</span>

<span class="c"># Pack reference coordinates</span>
yame pack <span class="nt">-f7</span> cpg_coords.bed <span class="o">&gt;</span> cpg_reference.cr
</code></pre></div></div> <p><strong>Output:</strong> <code class="language-plaintext highlighter-rouge">.cr</code> file (CpG reference)</p> <p><strong>Compression:</strong> Delta encoding of positions for maximum compression</p><hr /> <h2 id="creating-feature-files---complete-guide"> <a href="#creating-feature-files---complete-guide" class="anchor-heading" aria-labelledby="creating-feature-files---complete-guide"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating Feature Files - Complete Guide </h2> <p>Feature files (format 2) are essential for enrichment testing and feature-based analysis. Here’s the complete workflow.</p> <h3 id="example-1-chromhmm-chromatin-states"> <a href="#example-1-chromhmm-chromatin-states" class="anchor-heading" aria-labelledby="example-1-chromhmm-chromatin-states"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example 1: ChromHMM Chromatin States </h3> <p>This detailed example shows how to create a ChromHMM feature file from full-stack chromatin state annotations.</p> <h4 id="input-data-format"> <a href="#input-data-format" class="anchor-heading" aria-labelledby="input-data-format"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Input Data Format </h4> <p>Your ChromHMM BED file (<code class="language-plaintext highlighter-rouge">hg38_chromhmm_100_segments.bed.gz</code>) should look like:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chr1    10000   10400   1_TssA
chr1    10400   10600   2_TssFlnk
chr1    10600   10800   8_EnhW1
chr1    10800   12800   15_Quies
chr1    12800   13000   8_EnhW1
chr1    13000   13200   7_EnhG2
chr1    13200   14800   15_Quies
</code></pre></div></div> <p><strong>Column format:</strong></p> <ol> <li>Chromosome</li> <li>Start position</li> <li>End position</li> <li>Chromatin state label</li> </ol> <h4 id="step-by-step-workflow"> <a href="#step-by-step-workflow" class="anchor-heading" aria-labelledby="step-by-step-workflow"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step-by-Step Workflow </h4> <p><strong>Step 1: Prepare reference CpG coordinates</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Unpack reference .cr file to BED format</span>
yame unpack cpg_nocontig.cr | <span class="nb">gzip</span> <span class="o">&gt;</span> cpg_nocontig.bed.gz

<span class="c"># Verify it worked</span>
zcat cpg_nocontig.bed.gz | <span class="nb">head</span> <span class="nt">-3</span>
<span class="c"># chr1    10468   10469   chr1_10469</span>
<span class="c"># chr1    10470   10471   chr1_10471</span>
<span class="c"># chr1    10483   10484   chr1_10484</span>
</code></pre></div></div> <p><strong>Step 2: Intersect CpGs with chromatin states</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>zcat hg38_chromhmm_100_segments.bed.gz | <span class="se">\</span>
  bedtools <span class="nb">sort</span> | <span class="se">\</span>
  bedtools intersect <span class="nt">-a</span> cpg_nocontig.bed.gz <span class="nt">-b</span> - <span class="nt">-loj</span> <span class="nt">-sorted</span> | <span class="se">\</span>
  bedtools groupby <span class="nt">-g</span> 1-3 <span class="nt">-c</span> 7 <span class="nt">-o</span> first | <span class="se">\</span>
  <span class="nb">cut</span> <span class="nt">-f4</span> | <span class="se">\</span>
  yame pack <span class="nt">-f2</span> - <span class="o">&gt;</span> ChromHMM_FullStack.cm
</code></pre></div></div> <p><strong>Command breakdown:</strong></p> <ul> <li><code class="language-plaintext highlighter-rouge">zcat ... | bedtools sort</code> - Ensure chromatin state BED is sorted</li> <li><code class="language-plaintext highlighter-rouge">bedtools intersect -loj</code> - Left outer join: keep ALL reference CpGs <ul> <li>CpGs overlapping states get the state label</li> <li>CpGs not overlapping any state get “.” (NA)</li> </ul> </li> <li><code class="language-plaintext highlighter-rouge">bedtools groupby -g 1-3 -c 7 -o first</code> - For CpGs in multiple states, take first</li> <li><code class="language-plaintext highlighter-rouge">cut -f4</code> - Extract the state label (4th column is state name)</li> <li><code class="language-plaintext highlighter-rouge">yame pack -f2 -</code> - Pack as format 2 (categorical state data)</li> </ul> <p><strong>Step 3: Verify the output</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check file info</span>
yame info ChromHMM_FullStack.cm

<span class="c"># Preview state distribution</span>
yame unpack ChromHMM_FullStack.cm | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-c</span> | <span class="nb">sort</span> <span class="nt">-rn</span> | <span class="nb">head</span>
</code></pre></div></div> <p><strong>Step 4: Use for enrichment testing</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yame summary <span class="nt">-m</span> ChromHMM_FullStack.cm query.cg <span class="o">&gt;</span> enrichment_results.txt
</code></pre></div></div><hr /> <h3 id="example-2-histone-modification-peaks"> <a href="#example-2-histone-modification-peaks" class="anchor-heading" aria-labelledby="example-2-histone-modification-peaks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example 2: Histone Modification Peaks </h3> <p>Create feature file from ChIP-seq peaks:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Single histone mark</span>
bedtools intersect <span class="nt">-a</span> cpg_ref.bed.gz <span class="nt">-b</span> H3K4me3_peaks.bed <span class="nt">-sorted</span> <span class="nt">-c</span> | <span class="se">\</span>
  <span class="nb">cut</span> <span class="nt">-f4</span> | <span class="se">\</span>
  yame pack <span class="nt">-fb</span> - <span class="o">&gt;</span> H3K4me3.cm

<span class="c"># Multiple marks - see sample.markdown for merging multiple features</span>
</code></pre></div></div><hr /> <h3 id="example-3-gene-annotations"> <a href="#example-3-gene-annotations" class="anchor-heading" aria-labelledby="example-3-gene-annotations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example 3: Gene Annotations </h3> <p>Create features for different gene regions:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Promoters (2kb upstream of TSS)</span>
bedtools intersect <span class="nt">-a</span> cpg_ref.bed.gz <span class="nt">-b</span> promoters.bed <span class="nt">-sorted</span> <span class="nt">-c</span> | <span class="se">\</span>
  <span class="nb">cut</span> <span class="nt">-f4</span> | <span class="se">\</span>
  yame pack <span class="nt">-fb</span> - <span class="o">&gt;</span> promoters.cm

<span class="c"># Exons</span>
bedtools intersect <span class="nt">-a</span> cpg_ref.bed.gz <span class="nt">-b</span> exons.bed <span class="nt">-sorted</span> <span class="nt">-c</span> | <span class="se">\</span>
  <span class="nb">cut</span> <span class="nt">-f4</span> | <span class="se">\</span>
  yame pack <span class="nt">-fb</span> - <span class="o">&gt;</span> exons.cm

<span class="c"># Gene bodies</span>
bedtools intersect <span class="nt">-a</span> cpg_ref.bed.gz <span class="nt">-b</span> gene_bodies.bed <span class="nt">-sorted</span> <span class="nt">-c</span> | <span class="se">\</span>
  <span class="nb">cut</span> <span class="nt">-f4</span> | <span class="se">\</span>
  yame pack <span class="nt">-fb</span> - <span class="o">&gt;</span> gene_bodies.cm
</code></pre></div></div><hr /> <h3 id="example-4-genomic-binswindows"> <a href="#example-4-genomic-binswindows" class="anchor-heading" aria-labelledby="example-4-genomic-binswindows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example 4: Genomic Bins/Windows </h3> <p>Create fixed-size genomic windows:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 1. Create 100kb windows</span>
bedtools makewindows <span class="nt">-g</span> hg38.genome <span class="nt">-w</span> 100000 | <span class="se">\</span>
  <span class="nb">awk</span> <span class="s1">'{print $0"\tchr"$1":"$2/100000}'</span> <span class="o">&gt;</span> windows_100kb.bed

<span class="c"># 2. Assign CpGs to windows</span>
yame unpack cpg_ref.cr | <span class="se">\</span>
  bedtools intersect <span class="nt">-a</span> - <span class="nt">-b</span> windows_100kb.bed <span class="nt">-loj</span> <span class="nt">-sorted</span> | <span class="se">\</span>
  bedtools groupby <span class="nt">-g</span> 1-3 <span class="nt">-c</span> 7 <span class="nt">-o</span> first | <span class="se">\</span>
  <span class="nb">cut</span> <span class="nt">-f4</span> | <span class="se">\</span>
  yame pack <span class="nt">-f2</span> - <span class="o">&gt;</span> bins_100kb.cm

<span class="c"># 3. Use for single-cell aggregation</span>
yame summary <span class="nt">-m</span> bins_100kb.cm single_cell.cg <span class="o">&gt;</span> binned_methylation.txt
</code></pre></div></div><hr /> <h3 id="example-5-custom-region-sets"> <a href="#example-5-custom-region-sets" class="anchor-heading" aria-labelledby="example-5-custom-region-sets"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example 5: Custom Region Sets </h3> <p>Create feature from any custom BED file:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Your custom regions (e.g., enhancers, TADs, etc.)</span>
<span class="c"># custom_regions.bed format:</span>
<span class="c"># chr1    100000  102000  enhancer_1</span>
<span class="c"># chr1    150000  153000  enhancer_2</span>

bedtools intersect <span class="nt">-a</span> cpg_ref.bed.gz <span class="nt">-b</span> custom_regions.bed <span class="nt">-loj</span> <span class="nt">-sorted</span> | <span class="se">\</span>
  bedtools groupby <span class="nt">-g</span> 1-3 <span class="nt">-c</span> 7 <span class="nt">-o</span> first | <span class="se">\</span>
  <span class="nb">cut</span> <span class="nt">-f4</span> | <span class="se">\</span>
  yame pack <span class="nt">-f2</span> - <span class="o">&gt;</span> custom_features.cm
</code></pre></div></div><hr /> <h2 id="yame-unpack"> <a href="#yame-unpack" class="anchor-heading" aria-labelledby="yame-unpack"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> yame unpack </h2> <p>Convert CX binary format back to human-readable text.</p> <h3 id="basic-syntax-1"> <a href="#basic-syntax-1" class="anchor-heading" aria-labelledby="basic-syntax-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Basic Syntax </h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yame unpack <span class="o">[</span>options] &lt;cx_file&gt;
</code></pre></div></div> <h3 id="common-options"> <a href="#common-options" class="anchor-heading" aria-labelledby="common-options"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Common Options </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Option</th> <th>Description</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">-a</code></td> <td>Unpack all samples</td> <td><code class="language-plaintext highlighter-rouge">yame unpack -a multi.cg</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">-f &lt;N&gt;</code></td> <td>Filter by min coverage</td> <td><code class="language-plaintext highlighter-rouge">yame unpack -f 5 data.cg</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">-s &lt;name&gt;</code></td> <td>Unpack specific sample</td> <td><code class="language-plaintext highlighter-rouge">yame unpack -s sample1 data.cg</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">-i &lt;index&gt;</code></td> <td>Unpack by sample index</td> <td><code class="language-plaintext highlighter-rouge">yame unpack -i 0 data.cg</code></td> </tr> </tbody> </table></div><hr /> <h2 id="unpacking-examples"> <a href="#unpacking-examples" class="anchor-heading" aria-labelledby="unpacking-examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Unpacking Examples </h2> <h3 id="format-3---mu-count-data"> <a href="#format-3---mu-count-data" class="anchor-heading" aria-labelledby="format-3---mu-count-data"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Format 3 - M/U Count Data </h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Unpack all samples with coverage &gt;= 1</span>
yame unpack <span class="nt">-a</span> <span class="nt">-f</span> 1 sequencing.cg

<span class="c"># Output format (tab-separated):</span>
<span class="c"># beta    coverage</span>
<span class="c"># 0.75    4</span>
<span class="c"># 0.33    3</span>
<span class="c"># 0.88    8</span>
<span class="c"># NA      0</span>
<span class="c"># 0.50    2</span>
</code></pre></div></div> <p><strong>Columns:</strong></p> <ul> <li><strong>Beta</strong>: Methylation fraction (M / (M+U))</li> <li><strong>Coverage</strong>: Total reads (M + U)</li> </ul> <h3 id="format-0b---binary-data-1"> <a href="#format-0b---binary-data-1" class="anchor-heading" aria-labelledby="format-0b---binary-data-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Format 0/b - Binary Data </h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Unpack binary data</span>
yame unpack binary_data.cg

<span class="c"># Output (one value per line):</span>
<span class="c"># 1</span>
<span class="c"># 0</span>
<span class="c"># 1</span>
<span class="c"># 1</span>
<span class="c"># 0</span>
</code></pre></div></div> <h3 id="format-2s---state-data"> <a href="#format-2s---state-data" class="anchor-heading" aria-labelledby="format-2s---state-data"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Format 2/s - State Data </h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Unpack chromatin states</span>
yame unpack ChromHMM.cm | <span class="nb">head</span> <span class="nt">-10</span>

<span class="c"># Output (state labels):</span>
<span class="c"># 1_TssA</span>
<span class="c"># 1_TssA</span>
<span class="c"># 3_TxFlnk</span>
<span class="c"># 4_Tx</span>
<span class="c"># 4_Tx</span>
<span class="c"># 7_Enh</span>
<span class="c"># 15_Quies</span>
</code></pre></div></div> <h3 id="format-7---reference-coordinates-1"> <a href="#format-7---reference-coordinates-1" class="anchor-heading" aria-labelledby="format-7---reference-coordinates-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Format 7 - Reference Coordinates </h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Unpack reference coordinates to BED</span>
yame unpack cpg_nocontig.cr <span class="o">&gt;</span> cpg_coordinates.bed

<span class="c"># Output (BED format):</span>
<span class="c"># chr1    10468   10469   chr1_10469</span>
<span class="c"># chr1    10470   10471   chr1_10471</span>
<span class="c"># chr1    10483   10484   chr1_10484</span>
</code></pre></div></div> <h3 id="unpacking-specific-samples"> <a href="#unpacking-specific-samples" class="anchor-heading" aria-labelledby="unpacking-specific-samples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Unpacking Specific Samples </h3> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check available samples first</span>
yame info multi_sample.cg

<span class="c"># Unpack specific sample</span>
yame unpack <span class="nt">-s</span> <span class="s2">"sample_A"</span> multi_sample.cg <span class="o">&gt;</span> sample_A.txt

<span class="c"># Unpack first sample (index 0)</span>
yame unpack <span class="nt">-i</span> 0 multi_sample.cg <span class="o">&gt;</span> first_sample.txt
</code></pre></div></div><hr /> <h2 id="practical-workflows"> <a href="#practical-workflows" class="anchor-heading" aria-labelledby="practical-workflows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Practical Workflows </h2> <h3 id="workflow-1-process-bisulfite-sequencing-data"> <a href="#workflow-1-process-bisulfite-sequencing-data" class="anchor-heading" aria-labelledby="workflow-1-process-bisulfite-sequencing-data"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Workflow 1: Process Bisulfite Sequencing Data </h3> <p>Complete pipeline from bisulfite sequencing output to analysis:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Assuming you have M and U counts from your pipeline</span>
<span class="c"># Format: chr start end M U</span>

<span class="c"># 1. Extract M and U, align with reference</span>
bedtools intersect <span class="nt">-a</span> cpg_ref.bed.gz <span class="nt">-b</span> methylation_calls.bed <span class="nt">-loj</span> <span class="nt">-sorted</span> | <span class="se">\</span>
  <span class="nb">awk</span> <span class="s1">'{if ($8==".") print "0\t0"; else print $8"\t"$9}'</span> | <span class="se">\</span>
  yame pack <span class="nt">-f3</span> - <span class="o">&gt;</span> sample.cg

<span class="c"># 2. Verify data quality</span>
yame info sample.cg
yame summary sample.cg

<span class="c"># 3. Perform enrichment analysis</span>
yame summary <span class="nt">-m</span> ChromHMM.cm sample.cg <span class="o">&gt;</span> chromatin_enrichment.txt
yame summary <span class="nt">-m</span> genes.cm sample.cg <span class="o">&gt;</span> gene_enrichment.txt

<span class="c"># 4. If needed, unpack for external tools</span>
yame unpack <span class="nt">-f</span> 5 sample.cg <span class="o">&gt;</span> sample_cov5.txt
</code></pre></div></div><hr /> <h3 id="workflow-2-create-multi-feature-database"> <a href="#workflow-2-create-multi-feature-database" class="anchor-heading" aria-labelledby="workflow-2-create-multi-feature-database"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Workflow 2: Create Multi-Feature Database </h3> <p>Build comprehensive feature database:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c"># Create comprehensive feature database for hg38</span>

<span class="c"># 1. Prepare reference</span>
yame unpack cpg_nocontig.cr | <span class="nb">gzip</span> <span class="o">&gt;</span> cpg_ref.bed.gz

<span class="c"># 2. Download and process multiple features</span>
<span class="nb">declare</span> <span class="nt">-A</span> <span class="nv">features</span><span class="o">=(</span>
  <span class="o">[</span><span class="s2">"ChromHMM_15"</span><span class="o">]=</span><span class="s2">"ChromHMM_15state.bed.gz"</span>
  <span class="o">[</span><span class="s2">"CpG_Islands"</span><span class="o">]=</span><span class="s2">"cpgIslandExt.bed.gz"</span>
  <span class="o">[</span><span class="s2">"Promoters"</span><span class="o">]=</span><span class="s2">"promoters_2kb.bed.gz"</span>
  <span class="o">[</span><span class="s2">"Enhancers"</span><span class="o">]=</span><span class="s2">"enhancers_merged.bed.gz"</span>
  <span class="o">[</span><span class="s2">"TFBS"</span><span class="o">]=</span><span class="s2">"tfbs_combined.bed.gz"</span>
<span class="o">)</span>

<span class="c"># 3. Create individual feature files</span>
<span class="k">for </span>name <span class="k">in</span> <span class="s2">"</span><span class="k">${</span><span class="p">!features[@]</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">do
  </span><span class="nv">file</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">features</span><span class="p">[</span><span class="nv">$name</span><span class="p">]</span><span class="k">}</span><span class="s2">"</span>
  <span class="nb">echo</span> <span class="s2">"Processing </span><span class="nv">$name</span><span class="s2">..."</span>
  
  zcat <span class="s2">"</span><span class="nv">$file</span><span class="s2">"</span> | bedtools <span class="nb">sort</span> | <span class="se">\</span>
    bedtools intersect <span class="nt">-a</span> cpg_ref.bed.gz <span class="nt">-b</span> - <span class="nt">-loj</span> <span class="nt">-sorted</span> | <span class="se">\</span>
    bedtools groupby <span class="nt">-g</span> 1-3 <span class="nt">-c</span> 7 <span class="nt">-o</span> first | <span class="se">\</span>
    <span class="nb">cut</span> <span class="nt">-f4</span> | <span class="se">\</span>
    yame pack <span class="nt">-f2</span> - <span class="o">&gt;</span> <span class="s2">"</span><span class="k">${</span><span class="nv">name</span><span class="k">}</span><span class="s2">.cm"</span>
<span class="k">done

</span><span class="nb">echo</span> <span class="s2">"Feature files created:"</span>
<span class="nb">ls</span> <span class="nt">-lh</span> <span class="k">*</span>.cm
</code></pre></div></div><hr /> <h3 id="workflow-3-convert-array-data-to-cx-format"> <a href="#workflow-3-convert-array-data-to-cx-format" class="anchor-heading" aria-labelledby="workflow-3-convert-array-data-to-cx-format"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Workflow 3: Convert Array Data to CX Format </h3> <p>Convert Illumina array data:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c"># Convert 450k/EPIC array data to CX format</span>

<span class="c"># Assuming you have: array_data.txt with columns: ProbeID, Beta</span>

<span class="c"># 1. Get array manifest with probe coordinates</span>
<span class="c"># manifest.bed format: chr start end ProbeID</span>

<span class="c"># 2. Intersect with reference CpGs</span>
bedtools intersect <span class="nt">-a</span> cpg_ref.bed.gz <span class="nt">-b</span> manifest.bed <span class="nt">-loj</span> <span class="nt">-sorted</span> <span class="o">&gt;</span> probe_cpg_map.bed

<span class="c"># 3. Map betas to CpG positions</span>
<span class="nb">join</span> <span class="nt">-1</span> 4 <span class="nt">-2</span> 1 <span class="nt">-t</span><span class="s1">$'</span><span class="se">\t</span><span class="s1">'</span> <span class="se">\</span>
  &lt;<span class="o">(</span><span class="nb">sort</span> <span class="nt">-k4</span>,4 probe_cpg_map.bed<span class="o">)</span> <span class="se">\</span>
  &lt;<span class="o">(</span><span class="nb">sort</span> <span class="nt">-k1</span>,1 array_data.txt<span class="o">)</span> | <span class="se">\</span>
  <span class="nb">sort</span> <span class="nt">-k2</span>,2 <span class="nt">-k3</span>,3n | <span class="se">\</span>
  <span class="nb">cut</span> <span class="nt">-f7</span> | <span class="se">\</span>
  <span class="nb">awk</span> <span class="s1">'{if ($1=="") print "NA"; else print $1}'</span> | <span class="se">\</span>
  yame pack <span class="nt">-f4</span> - <span class="o">&gt;</span> array_sample.cg

<span class="nb">echo</span> <span class="s2">"Array data converted to CX format"</span>
yame info array_sample.cg
</code></pre></div></div><hr /> <h3 id="workflow-4-quality-control-pipeline"> <a href="#workflow-4-quality-control-pipeline" class="anchor-heading" aria-labelledby="workflow-4-quality-control-pipeline"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Workflow 4: Quality Control Pipeline </h3> <p>Systematic QC for methylation data:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c"># QC pipeline for CX files</span>

<span class="nv">CX_FILE</span><span class="o">=</span><span class="nv">$1</span>

<span class="nb">echo</span> <span class="s2">"=== Quality Control Report for </span><span class="nv">$CX_FILE</span><span class="s2"> ==="</span>
<span class="nb">echo</span>

<span class="c"># 1. Basic file info</span>
<span class="nb">echo</span> <span class="s2">"File Information:"</span>
yame info <span class="nv">$CX_FILE</span>
<span class="nb">echo</span>

<span class="c"># 2. Coverage statistics</span>
<span class="nb">echo</span> <span class="s2">"Coverage Statistics:"</span>
yame summary <span class="nv">$CX_FILE</span>
<span class="nb">echo</span>

<span class="c"># 3. CpG island enrichment (should be enriched)</span>
<span class="nb">echo</span> <span class="s2">"CpG Island Enrichment:"</span>
yame summary <span class="nt">-m</span> CpG_islands.cm <span class="nv">$CX_FILE</span> | <span class="nb">awk</span> <span class="s1">'NR&gt;1 {print "Log2OR:", $9}'</span>
<span class="nb">echo</span>

<span class="c"># 4. Check coverage distribution</span>
<span class="nb">echo</span> <span class="s2">"Coverage Distribution:"</span>
yame unpack <span class="nt">-a</span> <span class="nv">$CX_FILE</span> | <span class="se">\</span>
  <span class="nb">awk</span> <span class="s1">'{cov=$2} cov&gt;0 {if(cov&lt;5) low++; else if(cov&lt;10) med++; else high++} 
       END{print "Low(&lt;5):", low, "Med(5-10):", med, "High(&gt;10):", high}'</span>
<span class="nb">echo</span>

<span class="c"># 5. Methylation distribution</span>
<span class="nb">echo</span> <span class="s2">"Methylation Distribution:"</span>
yame unpack <span class="nt">-a</span> <span class="nv">$CX_FILE</span> | <span class="se">\</span>
  <span class="nb">awk</span> <span class="s1">'$1!="NA" {beta=$1; if(beta&lt;0.3) hypo++; else if(beta&lt;0.7) inter++; else hyper++}
       END{print "Hypo(&lt;0.3):", hypo, "Inter(0.3-0.7):", inter, "Hyper(&gt;0.7):", hyper}'</span>

<span class="nb">echo
echo</span> <span class="s2">"=== QC Complete ==="</span>
</code></pre></div></div><hr /> <h2 id="best-practices"> <a href="#best-practices" class="anchor-heading" aria-labelledby="best-practices"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Best Practices </h2> <h3 id="for-packing"> <a href="#for-packing" class="anchor-heading" aria-labelledby="for-packing"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> For Packing </h3> <ol> <li><strong>Always align with reference first</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bedtools intersect <span class="nt">-a</span> cpg_ref.bed.gz <span class="nt">-b</span> your_data.bed <span class="nt">-sorted</span> <span class="nt">-c</span>
</code></pre></div> </div> </li> <li><strong>Verify dimensions match</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Count reference CpGs</span>
zcat cpg_ref.bed.gz | <span class="nb">wc</span> <span class="nt">-l</span>
   
<span class="c"># Count your data rows</span>
<span class="nb">wc</span> <span class="nt">-l</span> your_data.txt
</code></pre></div> </div> </li> <li><strong>Choose appropriate format</strong> <ul> <li>Binary (0/1) → Format 0</li> <li>States/categories → Format 2</li> <li>M,U counts → Format 3</li> <li>Fractions → Format 4</li> </ul> </li> <li><strong>Handle missing values properly</strong> <ul> <li>Format 3: Use M=0, U=0 for no coverage</li> <li>Format 4: Use “NA” for missing values</li> <li>Format 2: Use “.” for unassigned CpGs</li> </ul> </li> <li><strong>Test with small subset first</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">head</span> <span class="nt">-1000</span> data.txt | yame pack <span class="nt">-fb</span> - <span class="o">&gt;</span> test.cg
yame info test.cg
yame unpack test.cg | <span class="nb">head</span>
</code></pre></div> </div> </li> </ol> <h3 id="for-feature-files"> <a href="#for-feature-files" class="anchor-heading" aria-labelledby="for-feature-files"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> For Feature Files </h3> <ol> <li><strong>Use -loj (left outer join) for completeness</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bedtools intersect <span class="nt">-a</span> cpg_ref.bed.gz <span class="nt">-b</span> features.bed <span class="nt">-loj</span> <span class="nt">-sorted</span>
</code></pre></div> </div> </li> <li><strong>Handle overlapping features explicitly</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bedtools groupby <span class="nt">-g</span> 1-3 <span class="nt">-c</span> 7 <span class="nt">-o</span> first  <span class="c"># Take first</span>
<span class="c"># or</span>
bedtools groupby <span class="nt">-g</span> 1-3 <span class="nt">-c</span> 7 <span class="nt">-o</span> last   <span class="c"># Take last</span>
<span class="c"># or</span>
bedtools groupby <span class="nt">-g</span> 1-3 <span class="nt">-c</span> 7 <span class="nt">-o</span> collapse  <span class="c"># Keep all (comma-separated)</span>
</code></pre></div> </div> </li> <li><strong>Quality control your features</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yame summary feature.cm
<span class="c"># Check: N_mask (should be reasonable number of CpGs)</span>
</code></pre></div> </div> </li> <li><strong>Document feature creation</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Add comment in script</span>
<span class="c"># Feature: ChromHMM 15-state model</span>
<span class="c"># Source: ENCODE, hg38</span>
<span class="c"># Date created: 2025-01-15</span>
<span class="c"># Command: [paste command here]</span>
</code></pre></div> </div> </li> </ol> <h3 id="for-unpacking"> <a href="#for-unpacking" class="anchor-heading" aria-labelledby="for-unpacking"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> For Unpacking </h3> <ol> <li><strong>Filter by coverage when appropriate</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yame unpack <span class="nt">-f</span> 5 data.cg  <span class="c"># Only CpGs with coverage ≥ 5</span>
</code></pre></div> </div> </li> <li><strong>Pipe to reduce storage</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yame unpack data.cg | process_data.py  <span class="c"># Don't save intermediate</span>
</code></pre></div> </div> </li> <li><strong>Verify unpacked data</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yame unpack data.cg | <span class="nb">head</span>  <span class="c"># Check format</span>
yame unpack data.cg | <span class="nb">wc</span> <span class="nt">-l</span>  <span class="c"># Check row count</span>
</code></pre></div> </div> </li> </ol><hr /> <h2 id="format-selection-guide"> <a href="#format-selection-guide" class="anchor-heading" aria-labelledby="format-selection-guide"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Format Selection Guide </h2> <p>Choose the optimal format for your data:</p> <div class="table-wrapper"><table> <thead> <tr> <th>Your Data Type</th> <th>Format</th> <th>Command Example</th> </tr> </thead> <tbody> <tr> <td>DMR sites (yes/no)</td> <td>0/b</td> <td><code class="language-plaintext highlighter-rouge">yame pack -fb</code></td> </tr> <tr> <td>Differential calls (hypo/no/hyper)</td> <td>5</td> <td><code class="language-plaintext highlighter-rouge">yame pack -f5</code></td> </tr> <tr> <td>Chromatin states</td> <td>2/s</td> <td><code class="language-plaintext highlighter-rouge">yame pack -f2</code></td> </tr> <tr> <td>ChIP-seq peaks</td> <td>0/b</td> <td><code class="language-plaintext highlighter-rouge">yame pack -fb</code></td> </tr> <tr> <td>M and U counts</td> <td>3</td> <td><code class="language-plaintext highlighter-rouge">yame pack -f3</code></td> </tr> <tr> <td>450k array betas</td> <td>4</td> <td><code class="language-plaintext highlighter-rouge">yame pack -f4</code></td> </tr> <tr> <td>WGBS betas</td> <td>4</td> <td><code class="language-plaintext highlighter-rouge">yame pack -f4</code></td> </tr> <tr> <td>Gene annotations</td> <td>2/s</td> <td><code class="language-plaintext highlighter-rouge">yame pack -f2</code></td> </tr> <tr> <td>Genomic bins</td> <td>2/s</td> <td><code class="language-plaintext highlighter-rouge">yame pack -f2</code></td> </tr> <tr> <td>Query + background</td> <td>6</td> <td><code class="language-plaintext highlighter-rouge">yame pack -f6</code></td> </tr> <tr> <td>CpG coordinates</td> <td>7</td> <td><code class="language-plaintext highlighter-rouge">yame pack -f7</code></td> </tr> </tbody> </table></div><hr /> <h2 id="troubleshooting"> <a href="#troubleshooting" class="anchor-heading" aria-labelledby="troubleshooting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Troubleshooting </h2> <h3 id="common-issues"> <a href="#common-issues" class="anchor-heading" aria-labelledby="common-issues"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Common Issues </h3> <p><strong>Problem</strong>: “Dimension mismatch” error</p> <p><strong>Solution:</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check dimensions</span>
zcat cpg_ref.bed.gz | <span class="nb">wc</span> <span class="nt">-l</span>  <span class="c"># Reference</span>
<span class="nb">wc</span> <span class="nt">-l</span> your_data.txt            <span class="c"># Your data</span>

<span class="c"># These must match! If not:</span>
bedtools intersect <span class="nt">-a</span> cpg_ref.bed.gz <span class="nt">-b</span> your_data.bed <span class="nt">-loj</span> <span class="nt">-sorted</span> | <span class="se">\</span>
  bedtools groupby <span class="nt">-g</span> 1-3 <span class="nt">-c</span> 7 <span class="nt">-o</span> first | <span class="se">\</span>
  <span class="nb">cut</span> <span class="nt">-f4</span> <span class="o">&gt;</span> aligned_data.txt
</code></pre></div></div> <p><strong>Problem</strong>: Packed file is unexpectedly large</p> <p><strong>Solutions:</strong></p> <ul> <li>Check if you’re using the right format (binary data shouldn’t use format 3)</li> <li>Verify data is properly aligned</li> <li>Consider if data is actually compressible</li> </ul> <p><strong>Problem</strong>: Unpacked data shows all NAs</p> <p><strong>Solutions:</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check file format</span>
yame info yourfile.cg

<span class="c"># Verify data exists</span>
yame summary yourfile.cg

<span class="c"># Try unpacking without filters</span>
yame unpack yourfile.cg | <span class="nb">head</span>
</code></pre></div></div> <p><strong>Problem</strong>: Feature labels not showing in enrichment</p> <p><strong>Solutions:</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Verify format 2 was used</span>
yame info feature.cm

<span class="c"># Check labels</span>
yame unpack feature.cm | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-c</span>

<span class="c"># Recreate with proper format</span>
yame pack <span class="nt">-f2</span> states.txt <span class="o">&gt;</span> feature.cm
</code></pre></div></div> <p><strong>Problem</strong>: bedtools intersect produces wrong output</p> <p><strong>Solutions:</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Ensure proper sorting</span>
bedtools <span class="nb">sort</span> <span class="nt">-i</span> file1.bed <span class="o">&gt;</span> file1_sorted.bed
bedtools <span class="nb">sort</span> <span class="nt">-i</span> file2.bed <span class="o">&gt;</span> file2_sorted.bed

<span class="c"># Use -sorted flag</span>
bedtools intersect <span class="nt">-a</span> file1_sorted.bed <span class="nt">-b</span> file2_sorted.bed <span class="nt">-sorted</span>

<span class="c"># Check chromosome naming (chr1 vs 1)</span>
<span class="nb">head </span>file1.bed
<span class="nb">head </span>file2.bed
</code></pre></div></div> <p><strong>Problem</strong>: Memory errors when packing large files</p> <p><strong>Solutions:</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Process in chunks</span>
<span class="nb">split</span> <span class="nt">-l</span> 5000000 large_data.txt chunk_
<span class="k">for </span>chunk <span class="k">in </span>chunk_<span class="k">*</span><span class="p">;</span> <span class="k">do
  </span>yame pack <span class="nt">-fb</span> <span class="nv">$chunk</span> <span class="o">&gt;</span> <span class="k">${</span><span class="nv">chunk</span><span class="k">}</span>.cg
<span class="k">done</span>

<span class="c"># Combine (if needed)</span>
<span class="nb">cat </span>chunk_<span class="k">*</span>.cg <span class="o">&gt;</span> combined.cg
</code></pre></div></div><hr /> <h2 id="performance-optimization"> <a href="#performance-optimization" class="anchor-heading" aria-labelledby="performance-optimization"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Performance Optimization </h2> <h3 id="speed-tips"> <a href="#speed-tips" class="anchor-heading" aria-labelledby="speed-tips"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Speed Tips </h3> <ol> <li><strong>Use pipes to avoid I/O</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Slow (intermediate files)</span>
bedtools intersect ... <span class="o">&gt;</span> temp.bed
<span class="nb">cut</span> <span class="nt">-f4</span> temp.bed <span class="o">&gt;</span> temp2.txt
yame pack <span class="nt">-fb</span> temp2.txt <span class="o">&gt;</span> output.cg
   
<span class="c"># Fast (piped)</span>
bedtools intersect ... | <span class="nb">cut</span> <span class="nt">-f4</span> | yame pack <span class="nt">-fb</span> - <span class="o">&gt;</span> output.cg
</code></pre></div> </div> </li> <li><strong>Parallel processing for multiple files</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Process multiple samples in parallel</span>
parallel <span class="nt">-j</span> 8 <span class="s1">'yame pack -f3 {} &gt; {.}.cg'</span> ::: <span class="k">*</span>.txt
</code></pre></div> </div> </li> <li><strong>Pre-sort large files</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Sort once, use many times</span>
bedtools <span class="nb">sort</span> <span class="nt">-i</span> large_file.bed <span class="o">&gt;</span> large_file_sorted.bed
</code></pre></div> </div> </li> </ol> <h3 id="storage-tips"> <a href="#storage-tips" class="anchor-heading" aria-labelledby="storage-tips"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Storage Tips </h3> <ol> <li><strong>Don’t double-compress</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># CX files are already compressed, don't gzip them</span>
yame pack <span class="nt">-fb</span> data.txt <span class="o">&gt;</span> output.cg  <span class="c"># Good</span>
yame pack <span class="nt">-fb</span> data.txt | <span class="nb">gzip</span> <span class="o">&gt;</span> output.cg.gz  <span class="c"># Redundant</span>
</code></pre></div> </div> </li> <li><strong>Choose appropriate format</strong> <ul> <li>Format 0 for binary: ~32x compression</li> <li>Format 3 for M/U: ~10-20x compression</li> <li>Format 2 for states: Varies by number of categories</li> </ul> </li> <li><strong>Remove intermediate text files</strong> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yame pack <span class="nt">-fb</span> data.txt <span class="o">&gt;</span> data.cg <span class="o">&amp;&amp;</span> <span class="nb">rm </span>data.txt
</code></pre></div> </div> </li> </ol><hr /> <h2 id="validation-and-testing"> <a href="#validation-and-testing" class="anchor-heading" aria-labelledby="validation-and-testing"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Validation and Testing </h2> <p>Always validate your packed files:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c"># Validation script</span>

<span class="nv">CX_FILE</span><span class="o">=</span><span class="nv">$1</span>

<span class="nb">echo</span> <span class="s2">"Validating </span><span class="nv">$CX_FILE</span><span class="s2">..."</span>

<span class="c"># 1. Check file is valid CX format</span>
<span class="k">if </span>yame info <span class="nv">$CX_FILE</span> <span class="o">&gt;</span> /dev/null 2&gt;&amp;1<span class="p">;</span> <span class="k">then
  </span><span class="nb">echo</span>

</code></pre></div></div> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
